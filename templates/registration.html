{% extends "base.html" %}

{% block title %}Registration - Conference 2024{% endblock %}

{% block content %}
<div class="registration-section">
    <h1>Conference Registration</h1>

    <div class="registration-info">
        <p>All conference participants must pay the registration fee. For each paper/poster, at least one author must attend and pay the registration fee. Delegates can choose any of the options given below to participate at the Conference.</p>
    </div>

    <!-- Registration Fee Tables -->
    <div class="fee-tables">
        <!-- Early Bird Registration -->
        <div class="fee-section">
            <h2>Early Bird Registration</h2>
            <p class="deadline">Deadline: {{ fees.early_bird.deadline if fees and fees.early_bird else 'TBA' }}</p>
            <div class="fee-table">
                <div class="fee-row">
                    <span class="fee-type">Authors (Students)</span>
                    <span class="fee-amount">{% if fees and fees.early_bird and fees.early_bird.student_author %}${{ fees.early_bird.student_author }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Authors (Regular)</span>
                    <span class="fee-amount">{% if fees and fees.early_bird and fees.early_bird.regular_author %}${{ fees.early_bird.regular_author }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Listener</span>
                    <span class="fee-amount">{% if fees and fees.early_bird and fees.early_bird.listener %}${{ fees.early_bird.listener }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Virtual Delegate</span>
                    <span class="fee-amount">{% if fees and fees.early_bird and fees.early_bird.virtual %}${{ fees.early_bird.virtual }}{% else %}TBA{% endif %}</span>
                </div>
            </div>
            <a href="{{ url_for('registration') }}" class="btn-register">Register Now</a>
        </div>

        <!-- Early Registration -->
        <div class="fee-section">
            <h2>Early Registration</h2>
            <p class="deadline">Deadline: {{ fees.early.deadline if fees and fees.early else 'TBA' }}</p>
            <div class="fee-table">
                <div class="fee-row">
                    <span class="fee-type">Authors (Students)</span>
                    <span class="fee-amount">{% if fees and fees.early and fees.early.student_author %}${{ fees.early.student_author }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Authors (Regular)</span>
                    <span class="fee-amount">{% if fees and fees.early and fees.early.regular_author %}${{ fees.early.regular_author }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Listener</span>
                    <span class="fee-amount">{% if fees and fees.early and fees.early.listener %}${{ fees.early.listener }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Virtual Delegate</span>
                    <span class="fee-amount">{% if fees and fees.early and fees.early.virtual %}${{ fees.early.virtual }}{% else %}TBA{% endif %}</span>
                </div>
            </div>
            <a href="{{ url_for('registration') }}" class="btn-register">Register Now</a>
        </div>

        <!-- Late Registration -->
        <div class="fee-section">
            <h2>Late Registration</h2>
            <p class="deadline">Deadline: {{ fees.late.deadline if fees and fees.late else 'TBA' }}</p>
            <div class="fee-table">
                <div class="fee-row">
                    <span class="fee-type">Authors (Students)</span>
                    <span class="fee-amount">{% if fees and fees.late and fees.late.student_author %}${{ fees.late.student_author }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Authors (Regular)</span>
                    <span class="fee-amount">{% if fees and fees.late and fees.late.regular_author %}${{ fees.late.regular_author }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Listener</span>
                    <span class="fee-amount">{% if fees and fees.late and fees.late.listener %}${{ fees.late.listener }}{% else %}TBA{% endif %}</span>
                </div>
                <div class="fee-row">
                    <span class="fee-type">Virtual Delegate</span>
                    <span class="fee-amount">{% if fees and fees.late and fees.late.virtual %}${{ fees.late.virtual }}{% else %}TBA{% endif %}</span>
                </div>
            </div>
            <a href="{{ url_for('registration') }}" class="btn-register">Register Now</a>
        </div>
    </div>

    <!-- Registration Includes -->
    <div class="registration-includes">
        <h2>Conference Registration Fee Includes</h2>
        <ul>
            {% if fees and fees.includes %}
                {% for item in fees.includes %}
                    <li>{{ item }}</li>
                {% endfor %}
            {% else %}
                <li>Details will be announced soon</li>
            {% endif %}
        </ul>
    </div>

    <!-- Additional Information -->
    <div class="additional-info">
        <div class="info-card">
            <h3>Notice</h3>
            <ul>
                <li>Extra paper fee: {% if fees and fees.extra_paper_fee %}${{ fees.extra_paper_fee }}{% else %}TBA{% endif %}</li>
                <li>Fees apply ONLY to payments received by the indicated deadlines.</li>
                <li>Conference fee does not include accommodation and airport transfer.</li>
            </ul>
        </div>

        <div class="info-card">
            <h3>Cancellation Policy</h3>
            <p>In the case of non-attendance, the registration fee will not be refunded.</p>
        </div>
    </div>

    <!-- Payment Methods -->
    <div class="payment-methods">
        <h2>Payment Methods</h2>
        <p>Use the form below to register and pay ONLINE with credit card or PayPal or you can pay your registration fee through a bank transfer as per given information below:</p>

        {% if fees and fees.payment_details %}
        <div class="bank-details">
            <h3>Bank Transfer Details</h3>
            <table>
                <tr>
                    <th>Beneficiary</th>
                    <td>{{ fees.payment_details.beneficiary }}</td>
                </tr>
                <tr>
                    <th>IBAN</th>
                    <td>{{ fees.payment_details.iban }}</td>
                </tr>
                <tr>
                    <th>BIC</th>
                    <td>{{ fees.payment_details.bic }}</td>
                </tr>
                <tr>
                    <th>Beneficiary Address</th>
                    <td>{{ fees.payment_details.beneficiary_address }}</td>
                </tr>
                <tr>
                    <th>Bank Name</th>
                    <td>{{ fees.payment_details.bank_name }}</td>
                </tr>
                <tr>
                    <th>Bank Address</th>
                    <td>{{ fees.payment_details.bank_address }}</td>
                </tr>
                {% if fees.payment_details.intermediary_bic %}
                <tr>
                    <th>Intermediary BIC</th>
                    <td>{{ fees.payment_details.intermediary_bic }}</td>
                </tr>
                {% endif %}
            </table>

            <div class="bank-transfer-notice">
                <p>After sending your registration payment by bank wire transfer, scan the bank receipt and attach the PDF file in an email to: <a href="mailto:{{ fees.payment_details.contact_email }}">{{ fees.payment_details.contact_email }}</a></p>
            </div>
        </div>
        {% endif %}

        <div class="registration-types">
            <h3>Please choose your Registration Type:</h3>
            <div class="registration-buttons">
                <a href="{{ url_for('registration', registration_type='oral') }}" class="btn-type">Oral / Poster Registration</a>
                <a href="{{ url_for('registration', registration_type='listener') }}" class="btn-type">Listener Registration</a>
                <a href="{{ url_for('registration', registration_type='virtual') }}" class="btn-type">Virtual Registration</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    function calculateTotal() {
        let total = 0;
        const type = document.getElementById('registration_type').value;
        const isEarlyBird = new Date() < new Date('2024-03-31');
        
        // Base registration fee
        if (type === 'regular') {
            total += isEarlyBird ? 500 : 600;
        } else if (type === 'student') {
            total += isEarlyBird ? 300 : 400;
        } else if (type === 'ieee') {
            total += isEarlyBird ? 450 : 550;
        }

        // Additional options
        if (document.getElementById('workshop').checked) {
            total += 100;
        }
        if (document.getElementById('banquet').checked) {
            total += 50;
        }

        document.getElementById('total-amount').textContent = `$${total}`;
    }

    // Add event listeners for form changes
    document.getElementById('registration_type').addEventListener('change', calculateTotal);
    document.getElementById('workshop').addEventListener('change', calculateTotal);
    document.getElementById('banquet').addEventListener('change', calculateTotal);
});
</script>
{% endblock %} 